<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thống kê - Kho phụ tùng</title>

    <!-- Thư viện -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      rel="stylesheet"
    />
    <link href="../css/style.css" rel="stylesheet" />
  </head>
  <script>
    /* ===== Đồng bộ giao diện từ localStorage ===== */
    (function applyDashboardTheme() {
      const logo = localStorage.getItem("sidebarLogo");
      const color = localStorage.getItem("themeColor") || "#1e88e5";

      // Áp dụng logo nếu có
      const logoImg = document.getElementById("sidebarLogo");
      if (logo && logoImg) {
        logoImg.src = logo;
      }

      // Áp dụng màu theme (áp dụng cho tất cả phần tử sử dụng --primary)
      document.documentElement.style.setProperty("--primary", color);
    })();
  </script>
  <nav class="mobile-bottom-nav d-lg-none">
    <a href="./index.html"
      ><i class="bi bi-speedometer2"></i><span>Dashboard</span></a
    >
    <a href="./home.html"><i class="bi bi-box"></i><span>Kho</span></a>
    <a href="./stats.html"
      ><i class="bi bi-bar-chart"></i><span>Thống kê</span></a
    >
    <a href="./payment.html"
      ><i class="bi bi-cash-coin"></i><span>Thanh toán</span></a
    >
    <a href="./settings.html"><i class="bi bi-gear"></i><span>Cài đặt</span></a>
  </nav>
  <body>
    <!-- Trong .dashboard-header -->

    <!-- ... -->

    <!-- Overlay để click ra ngoài là đóng -->
    <div id="sidebarOverlay" class="sidebar-overlay d-lg-none"></div>

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">
      <div class="sidebar-header d-flex align-items-center mb-4">
        <div class="sidebar-logo">
          <img
            id="sidebarLogo"
            src="https://cdn-icons-png.flaticon.com/512/679/679922.png"
            alt="Logo"
          />
        </div>
        <h3 class="sidebar-title m-0 ms-2">Kho phụ tùng</h3>
      </div>
      <ul>
        <li>
          <a href="index.html"><i class="bi bi-speedometer2"></i> Dashboard</a>
        </li>
        <li>
          <a href="home.html"><i class="bi bi-box"></i> Quản lý kho</a>
        </li>
        <li>
          <a href="stats.html" class="active"
            ><i class="bi bi-bar-chart"></i> Thống kê</a
          >
        </li>
        <li>
          <a href="payment.html"><i class="bi bi-cash-coin"></i> Thanh toán</a>
        </li>
        <li>
          <a href="settings.html"><i class="bi bi-gear"></i> Cài đặt</a>
        </li>
      </ul>
    </aside>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="main">
      <div class="dashboard-header mb-4">
        <h2><i class="bi bi-bar-chart me-2"></i> Thống kê hoạt động</h2>
        <div class="text-muted small">Cập nhật: tháng 10/2025</div>
      </div>

      <div class="row g-4">
        <!-- Biểu đồ 1 -->
        <div class="col-md-6">
          <div class="chart-card animate__animated animate__fadeInUp">
            <h5><i class="bi bi-graph-up me-2"></i> Tồn kho theo hãng</h5>
            <canvas id="stockChart" height="200"></canvas>
          </div>
        </div>

        <!-- Biểu đồ 2 -->
        <div class="col-md-6">
          <div
            class="chart-card animate__animated animate__fadeInUp animate__delay-1s"
          >
            <h5><i class="bi bi-pie-chart me-2"></i> Tỷ lệ loại phụ tùng</h5>
            <canvas id="categoryChart" height="200"></canvas>
          </div>
        </div>

        <!-- Biểu đồ 3 -->
        <div class="col-md-12">
          <div
            class="chart-card animate__animated animate__fadeInUp animate__delay-2s"
          >
            <h5><i class="bi bi-cash-coin me-2"></i> Doanh thu theo tháng</h5>
            <canvas id="revenueChart" height="120"></canvas>
          </div>
        </div>
      </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      /* ====== Biểu đồ 1: Tồn kho theo hãng ====== */
      const ctxStock = document.getElementById("stockChart");
      new Chart(ctxStock, {
        type: "bar",
        data: {
          labels: ["Honda", "Yamaha", "SYM"],
          datasets: [
            {
              label: "Số lượng tồn kho",
              data: [120, 90, 45],
              backgroundColor: ["#1E88E5", "#43A047", "#FBC02D"],
              borderRadius: 8,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true } },
        },
      });

      /* ====== Biểu đồ 2: Tỷ lệ loại phụ tùng ====== */
      const ctxCategory = document.getElementById("categoryChart");
      new Chart(ctxCategory, {
        type: "doughnut",
        data: {
          labels: ["Đèn", "Phanh", "Phuộc", "Nhông sên dĩa", "Lọc gió"],
          datasets: [
            {
              data: [25, 15, 20, 30, 10],
              backgroundColor: [
                "#1E88E5",
                "#43A047",
                "#FBC02D",
                "#8E24AA",
                "#F4511E",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: "bottom",
              labels: { usePointStyle: true, font: { size: 13 } },
            },
          },
        },
      });

      /* ====== Biểu đồ 3: Doanh thu theo tháng ====== */
      const ctxRevenue = document.getElementById("revenueChart");
      new Chart(ctxRevenue, {
        type: "line",
        data: {
          labels: [
            "Th1",
            "Th2",
            "Th3",
            "Th4",
            "Th5",
            "Th6",
            "Th7",
            "Th8",
            "Th9",
            "Th10",
            "Th11",
            "Th12",
          ],
          datasets: [
            {
              label: "Doanh thu (triệu ₫)",
              data: [45, 60, 72, 81, 95, 98, 101, 109, 115, 125, 132, 140],
              borderColor: "#1E88E5",
              backgroundColor: "rgba(25,118,210,0.1)",
              fill: true,
              tension: 0.35,
              borderWidth: 3,
              pointRadius: 5,
              pointBackgroundColor: "#1565C0",
            },
          ],
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return value + "M";
                },
              },
            },
          },
        },
      });
    </script>
  </body>
</html>
